<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket æ¥å£æ–‡æ¡£ - Lineè´¦å·ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header .meta {
            opacity: 0.9;
            font-size: 0.9em;
        }
        
        .nav-links {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav-links a {
            color: #667eea;
            text-decoration: none;
            margin-right: 20px;
            font-weight: 500;
        }
        
        .nav-links a:hover {
            text-decoration: underline;
        }
        
        .section {
            background: white;
            padding: 30px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .section h3 {
            color: #764ba2;
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .section h4 {
            color: #555;
            font-size: 1.1em;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .endpoint {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #667eea;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .endpoint .method {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9em;
            margin-right: 10px;
        }
        
        .endpoint .url {
            font-family: 'Courier New', monospace;
            color: #333;
            font-weight: 500;
        }
        
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        code {
            font-family: 'Courier New', monospace;
        }
        
        .code-block {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .code-block code {
            color: #333;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }
        
        table tr:hover {
            background: #f8f9fa;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 500;
            margin-left: 8px;
        }
        
        .badge-required {
            background: #dc3545;
            color: white;
        }
        
        .badge-optional {
            background: #6c757d;
            color: white;
        }
        
        .badge-type {
            background: #17a2b8;
            color: white;
        }
        
        .message-type {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid #2196F3;
        }
        
        .message-type h4 {
            color: #2196F3;
            margin-top: 0;
        }
        
        .flow-step {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .flow-step strong {
            color: #856404;
        }
        
        ul, ol {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .note {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”Œ WebSocket æ¥å£æ–‡æ¡£</h1>
            <div class="meta">
                <strong>ç‰ˆæœ¬:</strong> v1.0 | 
                <strong>æ›´æ–°æ—¥æœŸ:</strong> 2025-12-23 | 
                <strong>è¯´æ˜:</strong> Windowså®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„å®Œæ•´äº¤äº’åè®®è®¾è®¡
            </div>
        </header>
        
        <div class="nav-links">
            <a href="#overview">åè®®æ¦‚è¿°</a>
            <a href="#connection">è¿æ¥æ–¹å¼</a>
            <a href="#client-messages">å®¢æˆ·ç«¯æ¶ˆæ¯</a>
            <a href="#server-messages">æœåŠ¡å™¨æ¶ˆæ¯</a>
            <a href="#examples">äº¤äº’ç¤ºä¾‹</a>
            <a href="/swagger/index.html">è¿”å› Swagger API æ–‡æ¡£</a>
        </div>
        
        <div class="section" id="overview">
            <h2>ğŸ“‹ åè®®æ¦‚è¿°</h2>
            
            <h3>é€šä¿¡æ–¹å¼</h3>
            <ul>
                <li><strong>WebSocket</strong>: å®æ—¶æ•°æ®ä¸ŠæŠ¥ã€å¿ƒè·³ä¿æŒè¿æ¥</li>
                <li><strong>HTTP/HTTPS</strong>: ç™»å½•è®¤è¯ã€æ‰¹é‡æ•°æ®ä¸Šä¼ </li>
            </ul>
            
            <h3>è®¤è¯æ–¹å¼</h3>
            <ul>
                <li>ä½¿ç”¨æ¿€æ´»ç è¿›è¡Œè®¤è¯</li>
                <li>æ”¯æŒä¸€ä¸ªå®¢æˆ·ç«¯ç™»å½•å¤šä¸ªæ¿€æ´»ç </li>
            </ul>
        </div>
        
        <div class="section" id="connection">
            <h2>ğŸ”Œ WebSocket è¿æ¥</h2>
            
            <h3>1. Windowså®¢æˆ·ç«¯è¿æ¥</h3>
            <div class="endpoint">
                <span class="method">WS</span>
                <span class="url">ws://localhost:8080/api/ws/client?activation_code={code}&token={token}</span>
            </div>
            
            <h4>è¿æ¥å‚æ•°:</h4>
            <table>
                <thead>
                    <tr>
                        <th>å‚æ•°</th>
                        <th>ç±»å‹</th>
                        <th>å¿…å¡«</th>
                        <th>è¯´æ˜</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>activation_code</code></td>
                        <td>string</td>
                        <td><span class="badge badge-required">å¿…å¡«</span></td>
                        <td>æ¿€æ´»ç </td>
                    </tr>
                    <tr>
                        <td><code>token</code></td>
                        <td>string</td>
                        <td><span class="badge badge-required">å¿…å¡«</span></td>
                        <td>ç™»å½•æ—¶è·å–çš„ä¸´æ—¶token</td>
                    </tr>
                </tbody>
            </table>
            
            <h4>è¿æ¥æˆåŠŸå“åº”:</h4>
            <pre><code>{
  "type": "auth_success",
  "data": {
    "group_id": 1,
    "activation_code": "ABC123",
    "message": "è®¤è¯æˆåŠŸï¼Œè¯·åŒæ­¥Lineè´¦å·åˆ—è¡¨"
  }
}</code></pre>
            
            <h3>2. å‰ç«¯çœ‹æ¿è¿æ¥</h3>
            <div class="endpoint">
                <span class="method">WS</span>
                <span class="url">ws://localhost:8080/api/ws/dashboard</span>
            </div>
            
            <div class="note">
                <strong>æ³¨æ„:</strong> å‰ç«¯çœ‹æ¿è¿æ¥éœ€è¦åœ¨ HTTP Header ä¸­ä¼ é€’ JWT Tokenï¼ˆæ ¼å¼ï¼š<code>Authorization: Bearer {token}</code>ï¼‰
            </div>
            
            <h3>3. å¤šæ¿€æ´»ç è¿æ¥</h3>
            <p>å®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å»ºç«‹å¤šä¸ªWebSocketè¿æ¥ï¼Œæ¯ä¸ªè¿æ¥ç‹¬ç«‹ç®¡ç†ï¼š</p>
            <div class="code-block">
                <code>
                    ws1: ws://domain.com/api/ws/client?activation_code=ABC123&token=xxx<br>
                    ws2: ws://domain.com/api/ws/client?activation_code=DEF456&token=yyy<br>
                    ws3: ws://domain.com/api/ws/client?activation_code=GHI789&token=zzz
                </code>
            </div>
        </div>
        
        <div class="section" id="client-messages">
            <h2>ğŸ“¤ å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨æ¶ˆæ¯</h2>
            
            <div class="message-type">
                <h4>1. å¿ƒè·³åŒ… (heartbeat)</h4>
                <p><strong>è§¦å‘æ—¶æœº:</strong> æ¯60ç§’å‘é€ä¸€æ¬¡</p>
                <p><strong>è¯´æ˜:</strong> æœåŠ¡å™¨æ›´æ–°è¯¥æ¿€æ´»ç çš„æœ€åæ´»è·ƒæ—¶é—´ï¼ŒæœåŠ¡å™¨ä¼šç«‹å³å›å¤å¿ƒè·³ç¡®è®¤æ¶ˆæ¯ï¼Œè¶…è¿‡65ç§’æœªæ”¶åˆ°å¿ƒè·³ï¼Œæ ‡è®°ä¸ºç¦»çº¿</p>
                <pre><code>{
  "type": "heartbeat",
  "activation_code": "ABC123",
  "timestamp": 1703123456
}</code></pre>
                <div class="note">
                    <strong>æœåŠ¡å™¨å›å¤:</strong> æœåŠ¡å™¨æ”¶åˆ°å¿ƒè·³åä¼šç«‹å³å›å¤ <code>heartbeat_ack</code> æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°æ­¤æ¶ˆæ¯è¡¨ç¤ºæœåŠ¡å™¨è¿æ¥æ­£å¸¸ã€‚
                </div>
            </div>
            
            <div class="message-type">
                <h4>2. åŒæ­¥Lineè´¦å·åˆ—è¡¨ (sync_line_accounts)</h4>
                <p><strong>è§¦å‘æ—¶æœº:</strong> WebSocketè¿æ¥æˆåŠŸåï¼Œæˆ–æ£€æµ‹åˆ°æœ¬åœ°Lineè´¦å·æœ‰å˜åŒ–æ—¶</p>
                <pre><code>{
  "type": "sync_line_accounts",
  "activation_code": "ABC123",
  "data": [
    {
      "line_id": "@line001",
      "display_name": "å¼ ä¸‰",
      "phone_number": "+886123456789",
      "platform_type": "line",
      "profile_url": "https://line.me/R/ti/p/@line001",
      "avatar_url": "https://...",
      "online_status": "online"
    }
  ]
}</code></pre>
                <h4>å­—æ®µè¯´æ˜:</h4>
                <table>
                    <thead>
                        <tr>
                            <th>å­—æ®µ</th>
                            <th>ç±»å‹</th>
                            <th>å¿…å¡«</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>line_id</code></td>
                            <td>string</td>
                            <td><span class="badge badge-required">å¿…å¡«</span></td>
                            <td>Lineè´¦å·çš„å”¯ä¸€æ ‡è¯†</td>
                        </tr>
                        <tr>
                            <td><code>platform_type</code></td>
                            <td>string</td>
                            <td><span class="badge badge-required">å¿…å¡«</span></td>
                            <td>å¹³å°ç±»å‹ï¼ˆline / line_businessï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>display_name</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>æ˜¾ç¤ºåç§°</td>
                        </tr>
                        <tr>
                            <td><code>phone_number</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>æ‰‹æœºå·</td>
                        </tr>
                        <tr>
                            <td><code>profile_url</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>ä¸»é¡µåœ°å€</td>
                        </tr>
                        <tr>
                            <td><code>avatar_url</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>å¤´åƒURL</td>
                        </tr>
                        <tr>
                            <td><code>online_status</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>åœ¨çº¿çŠ¶æ€</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="message-type">
                <h4>3. ä¸ŠæŠ¥è¿›çº¿æ•°æ® (incoming)</h4>
                <p><strong>è§¦å‘æ—¶æœº:</strong> æ£€æµ‹åˆ°æœ‰äººåŠ å¥½å‹ï¼ˆè¿›çº¿ï¼‰</p>
                <pre><code>{
  "type": "incoming",
  "activation_code": "ABC123",
  "data": {
    "line_account_id": "@line001",
    "incoming_line_id": "U123456789",
    "timestamp": "2025-12-21T10:30:00Z",
    "display_name": "ç‹äº”",
    "avatar_url": "https://...",
    "phone_number": "+886999888777"
  }
}</code></pre>
                <h4>å­—æ®µè¯´æ˜:</h4>
                <table>
                    <thead>
                        <tr>
                            <th>å­—æ®µ</th>
                            <th>ç±»å‹</th>
                            <th>å¿…å¡«</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>line_account_id</code></td>
                            <td>string</td>
                            <td><span class="badge badge-required">å¿…å¡«</span></td>
                            <td>å“ªä¸ªLineè´¦å·æ”¶åˆ°çš„è¿›çº¿ï¼ˆä½¿ç”¨line_idæ ‡è¯†ï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>incoming_line_id</code></td>
                            <td>string</td>
                            <td><span class="badge badge-required">å¿…å¡«</span></td>
                            <td>è¿›çº¿å®¢æˆ·çš„Line User ID</td>
                        </tr>
                        <tr>
                            <td><code>timestamp</code></td>
                            <td>string</td>
                            <td><span class="badge badge-required">å¿…å¡«</span></td>
                            <td>è¿›çº¿æ—¶é—´</td>
                        </tr>
                        <tr>
                            <td><code>display_name</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>å®¢æˆ·æ˜¾ç¤ºåç§°</td>
                        </tr>
                        <tr>
                            <td><code>avatar_url</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>å®¢æˆ·å¤´åƒ</td>
                        </tr>
                        <tr>
                            <td><code>phone_number</code></td>
                            <td>string</td>
                            <td><span class="badge badge-optional">å¯é€‰</span></td>
                            <td>å®¢æˆ·æ‰‹æœºå·</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="message-type">
                <h4>4. ä¸ŠæŠ¥å®¢æˆ·ä¿¡æ¯ (customer_sync)</h4>
                <p><strong>è§¦å‘æ—¶æœº:</strong> åœ¨Lineä¸Šä¸ºå®¢æˆ·æ·»åŠ äº†ç”»åƒä¿¡æ¯</p>
                <pre><code>{
  "type": "customer_sync",
  "activation_code": "ABC123",
  "data": {
    "line_account_id": "@line001",
    "customer_id": "U123456789",
    "display_name": "å¼ ä¸‰",
    "avatar_url": "https://...",
    "phone_number": "+886123456789",
    "gender": "male",
    "country": "Taiwan",
    "birthday": "1990-01-01",
    "address": "å°åŒ—å¸‚...",
    "remark": "VIPå®¢æˆ·"
  }
}</code></pre>
            </div>
            
            <div class="message-type">
                <h4>5. ä¸ŠæŠ¥è·Ÿè¿›è®°å½• (follow_up_sync)</h4>
                <p><strong>è§¦å‘æ—¶æœº:</strong> åœ¨Lineä¸Šä¸ºå®¢æˆ·æ·»åŠ äº†è·Ÿè¿›è®°å½•</p>
                <pre><code>{
  "type": "follow_up_sync",
  "activation_code": "ABC123",
  "data": {
    "line_account_id": "@line001",
    "customer_id": "U123456789",
    "content": "å·²è”ç³»å®¢æˆ·ï¼Œå®¢æˆ·è¡¨ç¤ºæœ‰å…´è¶£",
    "timestamp": "2025-12-21 11:00:00"
  }
}</code></pre>
            </div>
            
            <div class="message-type">
                <h4>6. Lineè´¦å·çŠ¶æ€å˜åŒ– (account_status_change)</h4>
                <p><strong>è§¦å‘æ—¶æœº:</strong> Lineè´¦å·ç™»å½•æˆ–é€€å‡º</p>
                <pre><code>{
  "type": "account_status_change",
  "activation_code": "ABC123",
  "data": {
    "line_account_id": "@line001",
    "online_status": "online",
    "timestamp": "2025-12-21 12:00:00"
  }
}</code></pre>
                <div class="note">
                    <strong>online_status å¯é€‰å€¼:</strong> <code>online</code> | <code>user_logout</code> | <code>abnormal_offline</code>
                </div>
            </div>
        </div>
        
        <div class="section" id="server-messages">
            <h2>ğŸ“¥ æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯æ¶ˆæ¯</h2>
            
            <div class="message-type">
                <h4>1. å¿ƒè·³ç¡®è®¤ (heartbeat_ack)</h4>
                <p><strong>è¯´æ˜:</strong> æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å¿ƒè·³åç«‹å³å›å¤ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°æ­¤æ¶ˆæ¯è¡¨ç¤ºæœåŠ¡å™¨è¿æ¥æ­£å¸¸ã€‚å¦‚æœé•¿æ—¶é—´æœªæ”¶åˆ°å¿ƒè·³å›å¤ï¼Œå®¢æˆ·ç«¯åº”æ£€æŸ¥è¿æ¥çŠ¶æ€ã€‚</p>
                <pre><code>{
  "type": "heartbeat_ack",
  "activation_code": "ABC123",
  "timestamp": 1703123456,
  "data": {
    "status": "ok",
    "message": "å¿ƒè·³æ­£å¸¸"
  }
}</code></pre>
                <div class="note">
                    <strong>æ³¨æ„:</strong> å‰ç«¯çœ‹æ¿å‘é€çš„å¿ƒè·³ç¡®è®¤æ¶ˆæ¯ä¸­ä¸åŒ…å« <code>activation_code</code> å­—æ®µã€‚
                </div>
            </div>
            
            <div class="message-type">
                <h4>2. è®¤è¯æˆåŠŸ (auth_success)</h4>
                <pre><code>{
  "type": "auth_success",
  "data": {
    "group_id": 1,
    "activation_code": "ABC123",
    "message": "è®¤è¯æˆåŠŸï¼Œè¯·åŒæ­¥Lineè´¦å·åˆ—è¡¨"
  }
}</code></pre>
            </div>
            
            <div class="message-type">
                <h4>3. è®¤è¯å¤±è´¥ (auth_error)</h4>
                <pre><code>{
  "type": "auth_error",
  "error": "æ¿€æ´»ç æ— æ•ˆæˆ–å·²è¢«ç¦ç”¨"
}</code></pre>
            </div>
            
            <div class="message-type">
                <h4>4. è´¦å·åŒæ­¥ç»“æœ (sync_result)</h4>
                <pre><code>{
  "type": "sync_result",
  "data": {
    "success": true,
    "created_count": 2,
    "updated_count": 1,
    "accounts": [
      {
        "line_id": "@line001",
        "account_id": 123,
        "status": "created"
      }
    ]
  }
}</code></pre>
            </div>
            
            <div class="message-type">
                <h4>5. è¿›çº¿æ•°æ®æ¥æ”¶ç¡®è®¤ (incoming_received)</h4>
                <pre><code>{
  "type": "incoming_received",
  "data": {
    "line_account_id": "@line001",
    "incoming_line_id": "U123456789",
    "status": "processed"
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>6. å®¢æˆ·åŒæ­¥æ¥æ”¶ç¡®è®¤ (customer_sync_received)</h4>
                <pre><code>{
  "type": "customer_sync_received",
  "data": {
    "customer_id": "U123456789",
    "customer_db_id": 1,
    "status": "processed"
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>7. è·Ÿè¿›è®°å½•åŒæ­¥æ¥æ”¶ç¡®è®¤ (follow_up_sync_received)</h4>
                <pre><code>{
  "type": "follow_up_sync_received",
  "data": {
    "customer_id": "U123456789",
    "follow_up_id": 1,
    "status": "processed"
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>8. è´¦å·çŠ¶æ€æ›´æ–°ç¡®è®¤ (account_status_updated)</h4>
                <pre><code>{
  "type": "account_status_updated",
  "data": {
    "line_account_id": "@line001",
    "online_status": "online",
    "status": "updated"
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>9. è¿›çº¿æ›´æ–°å¹¿æ’­ (incoming_update)</h4>
                <p><strong>è¯´æ˜:</strong> æœåŠ¡å™¨æ¨é€æ–°è¿›çº¿å®¢æˆ·ä¿¡æ¯åˆ°å‰ç«¯çœ‹æ¿</p>
                <pre><code>{
  "type": "incoming_update",
  "data": {
    "group_id": 1,
    "line_account_id": 1,
    "incoming_line_id": "U123456789",
    "is_duplicate": false,
    "timestamp": 1703123456
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>10. è´¦å·çŠ¶æ€å˜åŒ–å¹¿æ’­ (account_status_change)</h4>
                <p><strong>è¯´æ˜:</strong> æœåŠ¡å™¨æ¨é€è´¦å·çŠ¶æ€å˜åŒ–åˆ°å‰ç«¯çœ‹æ¿</p>
                <pre><code>{
  "type": "account_status_change",
  "data": {
    "line_account_id": "@line001",
    "online_status": "online",
    "group_id": 1,
    "timestamp": 1703123456
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>11. åˆ†ç»„ç»Ÿè®¡æ›´æ–°å¹¿æ’­ (group_stats_update)</h4>
                <p><strong>è¯´æ˜:</strong> æœåŠ¡å™¨æ¨é€åˆ†ç»„ç»Ÿè®¡æ•°æ®æ›´æ–°åˆ°å‰ç«¯çœ‹æ¿</p>
                <pre><code>{
  "type": "group_stats_update",
  "data": {
    "group_id": 1,
    "total_accounts": 10,
    "online_accounts": 8,
    "total_incoming": 100,
    "today_incoming": 50,
    "duplicate_incoming": 20,
    "today_duplicate": 5,
    "timestamp": 1703123456
  }
}</code></pre>
            </div>

            <div class="message-type">
                <h4>12. é”™è¯¯æ¶ˆæ¯ (error)</h4>
                <pre><code>{
  "type": "error",
  "error": "é”™è¯¯æè¿°ä¿¡æ¯"
}</code></pre>
            </div>
        </div>
        
        <div class="section" id="examples">
            <h2>ğŸ”„ å®Œæ•´äº¤äº’æµç¨‹ç¤ºä¾‹</h2>
            
            <h3>åœºæ™¯ï¼šå®¢æˆ·ç«¯æ·»åŠ æ–°æ¿€æ´»ç å¹¶ä¸ŠæŠ¥æ•°æ®</h3>
            
            <div class="flow-step">
                <strong>ç¬¬1æ­¥ï¼šå®¢æˆ·ç«¯HTTPç™»å½•</strong><br>
                <code>POST /api/client/login</code><br>
                <pre><code>{
  "activation_code": "ABC123"
}</code></pre>
            </div>
            
            <div class="flow-step">
                <strong>ç¬¬2æ­¥ï¼šå»ºç«‹WebSocketè¿æ¥</strong><br>
                <code>ws://domain.com/api/ws/client?activation_code=ABC123&token=xxx</code><br>
                æœåŠ¡å™¨è¿”å›è®¤è¯æˆåŠŸæ¶ˆæ¯
            </div>
            
            <div class="flow-step">
                <strong>ç¬¬3æ­¥ï¼šå®¢æˆ·ç«¯åŒæ­¥Lineè´¦å·åˆ—è¡¨</strong><br>
                å‘é€ <code>sync_line_accounts</code> æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨åˆ›å»ºæˆ–æ›´æ–°è´¦å·è®°å½•
            </div>
            
            <div class="flow-step">
                <strong>ç¬¬4æ­¥ï¼šå®¢æˆ·ç«¯å‘é€å¿ƒè·³ï¼ˆæ¯60ç§’ï¼‰</strong><br>
                å‘é€ <code>heartbeat</code> æ¶ˆæ¯ä¿æŒè¿æ¥
            </div>
            
            <div class="flow-step">
                <strong>ç¬¬5æ­¥ï¼šæ£€æµ‹åˆ°è¿›çº¿ï¼Œä¸ŠæŠ¥è¿›çº¿æ•°æ®</strong><br>
                å‘é€ <code>incoming</code> æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨å¤„ç†å»é‡ã€è®°å½•æ—¥å¿—ã€æ›´æ–°ç»Ÿè®¡
            </div>
            
            <div class="flow-step">
                <strong>ç¬¬6æ­¥ï¼šå®¢æˆ·ç«¯ä¸ŠæŠ¥å®¢æˆ·ç”»åƒ</strong><br>
                å‘é€ <code>customer_sync</code> æ¶ˆæ¯
            </div>
            
            <div class="flow-step">
                <strong>ç¬¬7æ­¥ï¼šå®¢æˆ·ç«¯ä¸ŠæŠ¥è·Ÿè¿›è®°å½•</strong><br>
                å‘é€ <code>follow_up_sync</code> æ¶ˆæ¯
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ¯ æ•°æ®å½’å±è§„åˆ™</h2>
            <p>æ¯æ¡æ•°æ®çš„å½’å±é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¡®å®šï¼š</p>
            <div class="code-block">
                <code>
                    æ¿€æ´»ç  + Line ID â†’ ç¡®å®šæ•°æ®å½’å±<br><br>
                    ç¤ºä¾‹ï¼š<br>
                    - æ¿€æ´»ç ABC123 + Lineè´¦å·@line001 â†’ åˆ†ç»„1çš„Lineè´¦å·1<br>
                    - æ¿€æ´»ç DEF456 + Lineè´¦å·@line002 â†’ åˆ†ç»„2çš„Lineè´¦å·2<br>
                    - æ¿€æ´»ç ABC123 + è¿›çº¿UVW789 + Lineè´¦å·@line001 â†’ åˆ†ç»„1çš„è¿›çº¿è®°å½•
                </code>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ“Š å»é‡èŒƒå›´è¯´æ˜</h2>
            
            <h3>1. å½“å‰æ¿€æ´»ç ï¼ˆæœ¬åˆ†ç»„å»é‡ï¼‰</h3>
            <ul>
                <li>åªæ£€æŸ¥è¯¥åˆ†ç»„ä¸‹çš„è¿›çº¿å†å²</li>
                <li>åªæ£€æŸ¥è¯¥åˆ†ç»„çš„åº•åº“æ•°æ®</li>
            </ul>
            
            <h3>2. å…¨å±€å»é‡</h3>
            <ul>
                <li>æ£€æŸ¥æ‰€æœ‰åˆ†ç»„çš„è¿›çº¿å†å²</li>
                <li>æ£€æŸ¥æ‰€æœ‰åˆ†ç»„çš„åº•åº“æ•°æ®</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>âœ… å·²ç¡®è®¤å†…å®¹</h2>
            <ul>
                <li>âœ… é€šä¿¡æ–¹å¼ï¼šWebSocket + HTTP</li>
                <li>âœ… è®¤è¯æ–¹å¼ï¼šæ¿€æ´»ç è®¤è¯</li>
                <li>âœ… å¤šæ¿€æ´»ç æ”¯æŒï¼šä¸€ä¸ªå®¢æˆ·ç«¯å¯ç™»å½•å¤šä¸ªæ¿€æ´»ç </li>
                <li>âœ… æ•°æ®å½’å±ï¼šé€šè¿‡æ¿€æ´»ç  + Line IDç¡®å®š</li>
                <li>âœ… ä¸ŠæŠ¥å†…å®¹ï¼šLineè´¦å·ã€è¿›çº¿ã€å®¢æˆ·ä¿¡æ¯ã€è·Ÿè¿›è®°å½•</li>
                <li>âœ… åœ¨çº¿åˆ¤æ–­ï¼šWebSocketè¿æ¥ = åœ¨çº¿</li>
                <li>âœ… å»é‡èŒƒå›´ï¼šæœ¬åˆ†ç»„ã€å…¨å±€ä¸¤ç§</li>
                <li>âœ… è¿›çº¿æ•°æ®ï¼šæœ€å°å¿…å¡« + å¯é€‰æ‰©å±•</li>
            </ul>
        </div>
        
        <div class="nav-links" style="margin-top: 40px;">
            <a href="#overview">è¿”å›é¡¶éƒ¨</a>
            <a href="/swagger/index.html">è¿”å› Swagger API æ–‡æ¡£</a>
        </div>
    </div>
</body>
</html>

